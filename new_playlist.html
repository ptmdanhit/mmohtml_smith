<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;" />

    <title>New Playlist</title>

    <link rel="shorcut icon" href="images/moment_icon.ico" type="images/moment_icon">
    <link rel='stylesheet' href='css/style.css' type='text/css' media='all' />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript" src="js/modernizr.custom.38677.js"></script>
    <!-- jQuery UI  -->
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.min.js"></script>

    <!-- Owl Carousel package -->
    <link rel="stylesheet" href="javascript/slider/owl.carousel.css">
    <link rel="stylesheet" href="javascript/slider/owl.theme.css">
    <script src="javascript/slider/owl.carousel.js"></script>
    <script src="js/jquery.gridly.js"></script>
    <link rel='stylesheet' href='js/jquery.gridly.css' type='text/css' media='all' />

    <!-- Our Carousel extension -->
    <script type="text/javascript" src="javascript/slider/carousel.js"></script>
    <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    <!-- jQuery -->
</head>

<body class="new_playlist">

    <header>
        <!-- HEADER -->
        <div class="header_container">
            <div class="inner container_active">

                <!-- Back Button -->
                <div class="column column_1">
                    <div class="column_inner container_active">
                        <a class="button_back button_back_full floatLeft" href="profile_playlist.html"></a>
                        <a class="button_back_highlight button_back_highlight_full floatLeft" href="javascript:void(0);"></a>
                    </div>
                </div>

                <div class="column column_2 hide_tablet">
                    <a href="#" class="ir">text</a>
                </div>

                <!-- Playlist Title -->
                <div class="column column_3and4">
                    <div class="column_inner column_search_playlist_inner">
                        <div class="search_form search_playlist">
                            <form class="">
                                <input type="search" placeholder="Playlist Title">
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Publish -->
                <div class="column column_5">
                    <div class="column_inner column_menu_inner">
                        <a href="profile_playlist.html" class="button_generic button_publish"></a>
                    </div>
                </div>

            </div>
        </div>  <!-- header_container -->

        <!-- INTRODUCTION -->
        <div class='introduction'></div>

    </header> <!-- header -->

    <div id="main">

        <!-- PLAYLISST SEQUENCE -->
        <div class="playlist_sequence">
            <div class="button_left"></div>
            <div class="playlist_sequence_container">
                <div id="playlist_carousel" class="playlist_sequence_container_inner container_active owl-carousel"></div>
            </div>
            <div class="button_right"></div>
        </div> <!-- playlist_sequence -->

        <!-- SUB-HEADER -->
        <div class="sub_header">
            <div class="subheader_container">
                <div class="subheader_container_inner">
                    <div class="subheader_inner container_active">

                        <!-- Search -->
                        <div class="column column_1and2">
                            <div class="column_inner">
                                <div class="search_form">
                                    <form id="form">
                                        <input type="search" name="esearch" placeholder="search">
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div class="column column_3 hide_tablet">
                            <a href="#" class="ir">text</a>
                        </div>

                        <div class="column column_4 hide_mobile">
                            <a href="#" class="ir">text</a>
                        </div>

                        <!-- Reorder -->
                        <div class="column column_5">
                            <div class="column_inner column_menu_inner">
                                <a class="button_generic button_reorder on"></a>
                                <a class="button_generic button_reorder off hidden"></a>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div> <!-- sub_header -->

        <!-- GRID -->
        <div class="grid">
            <div class="grid_container">
                <div class="grid_container_inner">
                    <div class="content container_active">
                        <div class='bookmark_item_menu_without_touch' data-title="Title #1" data-id='1'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #2" data-id='2'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #3" data-id='3'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #4" data-id='4'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #5" data-id='5'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #6" data-id='6'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #7" data-id='7'></div>
                        <div class='bookmark_item_menu_without_touch' data-title="Title #8" data-id='8'></div>
                    </div>
                </div>
            </div>
        </div> <!-- grid -->
    </div> <!-- main -->

    <footer>
    </footer>
    <script>
        jQuery(document).ready(function() {
            jQuery('.page_menu').click(function() {
                jQuery(this).next().show();
                return false;
            })
            jQuery('.media_menu_touch_clickregion').click(function() {
                jQuery(this).closest('.column_inner').find('.media_menu_popup').show();
                return false;
            })
            jQuery('.button_close').click(function() {
                jQuery(this).parent().hide();

            })
            if (Modernizr.touch) {}
            else{
                jQuery('.button_back').hover(function(){
                    jQuery(this).closest('.column_inner').find('.button_back_highlight').show();
                }, function() {
                    jQuery(this).closest('.column_inner').find('.button_back_highlight').hide();
                });
            }
        })
    </script>
    <script>


        $(document).ready(function() {
            var sortedElements = [];
            var sortedElementsDataIds = [];
            // Turn on reorder, disable carousel.
            $('.button_reorder.on').on("click tap", function(){

                // Play with classes to hide/show elements.
                $('.button_left, .button_right').addClass('hidden');
                $(this).addClass('hidden');
                $('.button_reorder.off').removeClass('hidden');

                owl.data('owlCarousel').reinit({
                     touchDrag  : false,
                     mouseDrag  : false
                 });

                // We create callback function that will pick up how
                // elements changed after successful reorder.
                var reordered = function($elements) {
                  sortedElements = [];
                  $elements.each(function() {
                    sortedElements.push($(this).html());
                  });
                };
                $('#playlist_carousel .owl-wrapper').gridly({
                  callbacks: { reordered: reordered }
                });


            });
            // Turn off reorder, enable carousel.
            $('.button_reorder.off').on("click tap", function(){

                // Play with classes to hide/show elements.
                $('.button_left, .button_right').removeClass('hidden');
                $(this).addClass('hidden');
                $('.button_reorder.on').removeClass('hidden');

                // If the soredElements array is present, it means that
                // the order has changed.
                if (typeof sortedElements[0] !== 'undefined') {
                    // If order has changed, we destroy current owl Carousel
                    $('#playlist_carousel .bookmark_item_menu_without_touch').parent().remove();

                    // And reinitialize it with none elements.
                    owl.data('owlCarousel').reinit({
                         touchDrag  : true,
                         mouseDrag  : true
                     });

                    // Now we append all the elements that were stored inside sortedElements,
                    // to see what is sortedElements see the "var reordered".
                    count = sortedElements.length;
                    $.each(sortedElements, function(index, element) {
                        owl.data('owlCarousel').addItem(element);
                        var $el = $('#playlist_carousel .bookmark_item_menu_without_touch[data-id="'+$(element).data('id')+'"]');
                        carousel.bindDeleteAction($el, owl, '.bookmark_item_menu_without_touch');
                        if(!--count) {
                            sortedElements = [];
                        }
                    });

                    // Reinitialize array when all elements are added and the
                    // owlCarousel was stripped out of any leftovers.
                    $('.owl-item .owl-wrapper-outer').parent().remove();
                    $('.owl-item .bookmark_item_menu_without_touch.hidden').parent().remove();
                    owl.data('owlCarousel').reinit({
                         touchDrag  : true,
                         mouseDrag  : true
                     });

                } else {
                    // If the sortedElements wasn't present, it means that order hasn't change
                    // do nothing but reinitialization of array with disabled events.
                    owl.data('owlCarousel').reinit({
                         touchDrag  : true,
                         mouseDrag  : true
                     });
                }

                $('#playlist_carousel .owl-wrapper').gridly('draggable', 'off');


            });
        });
    </script>
    <script type='text/javascript'>
        $('#playlist_carousel').load('templates/playlist_stub_items.html', function() {
            // Init carousel after stubs are loaded.
            owl = $('#playlist_carousel').owlCarousel({
                navigation : false,
                pagination : false,
                scrollPerPage : true,
                items : 5, // 5 items
                itemsDesktop : [1000,6], //5 items between 1000px and 901px
                itemsDesktopSmall : [900,4], // betweem 900px and 601px
                itemsTablet: [600,3], //2 items between 600 and 480
                itemsMobile: [480,2], //2 items between 480 and 0
            });
            carousel.enableKeyDowns(owl);
            carousel.enableEvents(owl, '.bookmark_item_menu_without_touch');
            carousel.bindCustomNavigation(owl,
                '.button_left',
                '.button_right'
            );
        });
    </script>
    <script type='text/javascript'>
        $('.introduction').each(function() {
            $(this).load('templates/introduction.html', function() {
                $("#close_title").on("click tap", function(event) {
                    event.preventDefault();
                    $('.introduction').hide();
                });
            });
        });
    </script>
    <script type='text/javascript'>
            $('.bookmark_item_menu_without_touch').load('templates/bookmark_item_menu_without_touch.html', function() {
                $($(this)).find('h5').html($(this).data('title'));
            });
    </script>
</body>
</html>
